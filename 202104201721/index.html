<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>Leaflare - 算法题trick</title>

      

      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
          
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">

          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js" integrity="sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy" crossorigin="anonymous"></script>
              
          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"
                  onload="renderMathInElement(document.body);"></script>
              
          
      

      
          <link rel="stylesheet" href="https://leaflare.github.io/site.css">
          
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">Leaflare</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;leaflare.github.io">
                            主页
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;leaflare.github.io&#x2F;categories">
                            分类
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;leaflare.github.io&#x2F;tags">
                            标签
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;github.com&#x2F;leaflare">
                            GitHub
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;leaflare.github.io">Leaflare</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;leaflare.github.io">
                                    主页
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;leaflare.github.io&#x2F;categories">
                                    分类
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;leaflare.github.io&#x2F;tags">
                                    标签
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;github.com&#x2F;leaflare">
                                    GitHub
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    


<div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content always-active">
        <nav id="TableOfContents">
            <ul>
                
                <li>
                    <a href="https://leaflare.github.io/202104201721/#bian-jie-qing-kuang-chu-li" class="toc-link">边界情况处理</a>
                    
                    <ul>
                        
                        <li>
                            <a href="https://leaflare.github.io/202104201721/#shao-bing" class="toc-link">哨兵</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
            </ul>
        </nav>
    </div>
</div>


<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;leaflare.github.io&#x2F;202104201721&#x2F;">算法题trick</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2021-04-20</span>
            
        </div>
    </header>

    <div class="post-content">
      <span id="continue-reading"></span><h1 id="bian-jie-qing-kuang-chu-li">边界情况处理</h1>
<h3 id="shao-bing">哨兵</h3>
<p>例题：<a href="https://leetcode-cn.com/problems/largest-rectangle-in-histogram/">84. 柱状图中最大的矩形</a></p>
<pre data-lang="c++" style="background-color:#2b303b;color:#c0c5ce;" class="language-c++ "><code class="language-c++" data-lang="c++"><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">iostream</span><span>&gt;
</span><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">vector</span><span>&gt;
</span><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">stack</span><span>&gt;
</span><span>
</span><span style="color:#b48ead;">using namespace</span><span> std;
</span><span>
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">Solution </span><span style="color:#eff1f5;">{
</span><span style="color:#b48ead;">public</span><span style="color:#eff1f5;">:
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">largestRectangleArea</span><span style="color:#eff1f5;">(vector&lt;</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;">&gt; </span><span>&amp;</span><span style="color:#bf616a;">heights</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">unsigned long</span><span style="color:#eff1f5;"> size </span><span>=</span><span style="color:#eff1f5;"> heights.</span><span style="color:#bf616a;">size</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(size </span><span>== </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">return</span><span style="color:#eff1f5;"> heights[</span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">];
</span><span style="color:#eff1f5;">        }
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> res </span><span>= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        stack&lt;</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;">&gt; stk;
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">for </span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> i </span><span>= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">; i </span><span>&lt;</span><span style="color:#eff1f5;"> size; </span><span>++</span><span style="color:#eff1f5;">i) {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#eff1f5;">stk.</span><span style="color:#bf616a;">empty</span><span style="color:#eff1f5;">() </span><span>&amp;&amp;</span><span style="color:#eff1f5;"> heights[stk.</span><span style="color:#bf616a;">top</span><span style="color:#eff1f5;">()] </span><span>&gt;</span><span style="color:#eff1f5;"> heights[i]) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> length </span><span>=</span><span style="color:#eff1f5;"> heights[stk.</span><span style="color:#bf616a;">top</span><span style="color:#eff1f5;">()];
</span><span style="color:#eff1f5;">                stk.</span><span style="color:#bf616a;">pop</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> weight </span><span>=</span><span style="color:#eff1f5;"> i;
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#eff1f5;">stk.</span><span style="color:#bf616a;">empty</span><span style="color:#eff1f5;">()) {
</span><span style="color:#eff1f5;">                    weight </span><span>=</span><span style="color:#eff1f5;"> i </span><span>-</span><span style="color:#eff1f5;"> stk.</span><span style="color:#bf616a;">top</span><span style="color:#eff1f5;">() </span><span>- </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">                }
</span><span style="color:#eff1f5;">                res </span><span>= </span><span style="color:#bf616a;">max</span><span style="color:#eff1f5;">(res, length </span><span>*</span><span style="color:#eff1f5;"> weight);
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">            stk.</span><span style="color:#bf616a;">push</span><span style="color:#eff1f5;">(i);
</span><span style="color:#eff1f5;">        }
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#eff1f5;">stk.</span><span style="color:#bf616a;">empty</span><span style="color:#eff1f5;">()) {
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> length </span><span>=</span><span style="color:#eff1f5;"> heights[stk.</span><span style="color:#bf616a;">top</span><span style="color:#eff1f5;">()];
</span><span style="color:#eff1f5;">            stk.</span><span style="color:#bf616a;">pop</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> weight </span><span>=</span><span style="color:#eff1f5;"> size;
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">if </span><span style="color:#eff1f5;">(</span><span>!</span><span style="color:#eff1f5;">stk.</span><span style="color:#bf616a;">empty</span><span style="color:#eff1f5;">()) {
</span><span style="color:#eff1f5;">                weight </span><span>=</span><span style="color:#eff1f5;"> size </span><span>-</span><span style="color:#eff1f5;"> stk.</span><span style="color:#bf616a;">top</span><span style="color:#eff1f5;">() </span><span>- </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">            res </span><span>= </span><span style="color:#bf616a;">max</span><span style="color:#eff1f5;">(res, length </span><span>*</span><span style="color:#eff1f5;"> weight);
</span><span style="color:#eff1f5;">        }
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">return</span><span style="color:#eff1f5;"> res;
</span><span style="color:#eff1f5;">    }
</span><span style="color:#eff1f5;">}</span><span>;
</span><span>
</span></code></pre>
<p>以上参考代码 需要考虑两种特殊的情况：</p>
<p>弹栈的时候，栈为空；
遍历完成以后，栈中还有元素；
为此可以我们可以在输入数组的两端加上两个高度为 0 （只要比 1 严格小都行）的柱形，可以回避上面这两种分类讨论。</p>
<p>这两个站在两边的柱形就是哨兵（Sentinel）。</p>
<p>有了这两个柱形：</p>
<p>左边的柱形（第 1 个柱形）由于它一定比输入数组里任何一个元素小，它肯定不会出栈，因此栈一定不会为空；</p>
<p>右边的柱形（第 2 个柱形）也正是因为它一定比输入数组里任何一个元素小，它会让所有输入数组里的元素出栈（第 1 个哨兵元素除外）。</p>
<h4 id="shi-yong-shao-bing-jing-jian-hou-de-dai-ma"><strong>使用哨兵精简后的代码</strong></h4>
<pre data-lang="c++" style="background-color:#2b303b;color:#c0c5ce;" class="language-c++ "><code class="language-c++" data-lang="c++"><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">Solution </span><span style="color:#eff1f5;">{
</span><span style="color:#b48ead;">public</span><span style="color:#eff1f5;">:
</span><span style="color:#eff1f5;">    </span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">largestRectangleArea</span><span style="color:#eff1f5;">(vector&lt;</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;">&gt;</span><span>&amp; </span><span style="color:#bf616a;">heights</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> ans </span><span>= </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">;
</span><span style="color:#eff1f5;">        heights.</span><span style="color:#bf616a;">insert</span><span style="color:#eff1f5;">(heights.</span><span style="color:#bf616a;">begin</span><span style="color:#eff1f5;">(), </span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">);  
</span><span style="color:#eff1f5;">        </span><span style="color:#65737e;">// 第一个元素为添0，可以避免栈为空的情况，下面的while不用判断 !stack.empty()，0可看作是所有元素中最小的值
</span><span style="color:#eff1f5;">        heights.</span><span style="color:#bf616a;">push_back</span><span style="color:#eff1f5;">(</span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">);                </span><span style="color:#65737e;">// 最后一个元素添0，是为了触发最后一个单调栈开始收缩
</span><span style="color:#eff1f5;">        vector&lt;</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;">&gt; stack </span><span>= </span><span style="color:#eff1f5;">{</span><span style="color:#d08770;">0</span><span style="color:#eff1f5;">};             </span><span style="color:#65737e;">// 第一个元素0，先入栈，是为了while里面的 stack.back() 第一次能取到值
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">for </span><span style="color:#eff1f5;">(</span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> i </span><span>= </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">; i </span><span>&lt;</span><span style="color:#eff1f5;"> heights.</span><span style="color:#bf616a;">size</span><span style="color:#eff1f5;">(); i</span><span>++</span><span style="color:#eff1f5;">) {
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">// 此时i指向新元素，当新元素小于此时的栈顶（i-1）时，单调栈开始收缩，
</span><span style="color:#eff1f5;">            </span><span style="color:#65737e;">// 第一个老栈顶肯定为i-1，否则不符合逻辑
</span><span style="color:#eff1f5;">            </span><span style="color:#b48ead;">while </span><span style="color:#eff1f5;">(heights[i] </span><span>&lt;</span><span style="color:#eff1f5;"> heights[stack.</span><span style="color:#bf616a;">back</span><span style="color:#eff1f5;">()]) {
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> curHeight </span><span>=</span><span style="color:#eff1f5;"> heights[stack.</span><span style="color:#bf616a;">back</span><span style="color:#eff1f5;">()];
</span><span style="color:#eff1f5;">                stack.</span><span style="color:#bf616a;">pop_back</span><span style="color:#eff1f5;">();
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> right </span><span>=</span><span style="color:#eff1f5;"> i </span><span>- </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">;            
</span><span style="color:#eff1f5;">                </span><span style="color:#65737e;">// 右边届是固定的，为第一个老栈顶，也是最初栈里面的最高点
</span><span style="color:#eff1f5;">                </span><span style="color:#b48ead;">int</span><span style="color:#eff1f5;"> left </span><span>=</span><span style="color:#eff1f5;"> stack.</span><span style="color:#bf616a;">back</span><span style="color:#eff1f5;">() </span><span>+ </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">;  
</span><span style="color:#eff1f5;">                </span><span style="color:#65737e;">// 每次更新左边，此时栈已经pop过了，所以栈顶为当前矩形左边届的前一个
</span><span style="color:#eff1f5;">                </span><span style="color:#65737e;">// +1这个位置可能就不在栈里，但是这个值一定大于curHeight，一定要用它做左边
</span><span style="color:#eff1f5;">                ans </span><span>= </span><span style="color:#bf616a;">max</span><span style="color:#eff1f5;">(ans, (right </span><span>-</span><span style="color:#eff1f5;"> left </span><span>+ </span><span style="color:#d08770;">1</span><span style="color:#eff1f5;">) </span><span>*</span><span style="color:#eff1f5;"> curHeight);
</span><span style="color:#eff1f5;">            }
</span><span style="color:#eff1f5;">            stack.</span><span style="color:#bf616a;">push_back</span><span style="color:#eff1f5;">(i);
</span><span style="color:#eff1f5;">        }
</span><span style="color:#eff1f5;">        </span><span style="color:#b48ead;">return</span><span style="color:#eff1f5;"> ans;
</span><span style="color:#eff1f5;">    }
</span><span style="color:#eff1f5;">}</span><span>;
</span></code></pre>

    </div>

    
    

    <div class="post-footer">
        
            
                <div class="post-tags">
                    
                        <a href="https://leaflare.github.io/tags/cram/">#Cram</a>
                    
                </div>
            
            

        

    </div>

    
    
</article>


                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https://leaflare.github.io/even.js" ></script>
      
    </body>

</html>
